test.forum=select * from forum t
yearly.count=select o.id, o.enterprisename, sv.value, t.sumvalue from (select * from yearly_count y where y.access_year=To_char(sysdate, 'yyyy')) t , organization o , string_value sv   where o.id= t.name and o.id=sv.node_id and sv.property_id='org-website' order by t.sumvalue desc
quarterly.count= select o.id, o.enterprisename,  sv.value, t.sumvalue  from (select * from quarterly_count q   where q.access_year=To_char(sysdate, 'yyyy') and q.access_quarter=Floor(To_char(sysdate, 'mm')/3)+1) t , organization o, string_value sv   where o.id= t.name and o.id=sv.node_id and sv.property_id='org-website' order by t.sumvalue desc
monthly.count= select o.id, o.enterprisename,  sv.value, t.sumvalue from (select * from  monthly_count m where m.access_year=To_char(sysdate, 'yyyy') and m.access_month= To_char(sysdate, 'mm')) t , organization o , string_value sv   where o.id= t.name and o.id=sv.node_id and sv.property_id='org-website' order by t.sumvalue desc
weekly.count=select o.id, o.enterprisename, sv.value, t.sumvalue from (select * from  weekly_count w where w.access_year=To_char(sysdate, 'yyyy')  and w.access_week= To_char(sysdate, 'WW')) t , organization o , string_value sv   where o.id= t.name and o.id=sv.node_id and sv.property_id='org-website' order by t.sumvalue desc
diary.count=select o.id, o.enterprisename, sv.value, t.sumvalue  from (select * from  diary_count d where To_char(d.access_date, 'yyyy-mm-dd')=To_char(sysdate, 'yyyy-mm-dd')) t , organization o , string_value sv where o.id= t.name and o.id=sv.node_id and sv.property_id='org-website' order by t.sumvalue desc

#分页
dbviewSqlModel= SELECT * FROM ( SELECT rownum rownum_ , row_.* FROM ( select {0}  from {1} {2} ) row_ WHERE rownum <= ? ) WHERE rownum_ > ?
hysjk_jjxy_year=select {0}  from {1} {2}
#分页总数
dbviewCountModel=select count(*)  from {0} {1}
#区域数据库分页总数
qyjsk_dbviewCountModel=select count(*)  from (select *  from {0} {1})

#一级行业到二级行业的映射
hydl_hyxl = select HYDM, hymc from hydmk t Where t.hydlm = ?

#一级行业到产品的映射
hydl_cp = select sxm, cpmc from cpdmk t Where t.hydlm =?

#行业数据库-〉基本概况：根据行业和年查询经济类型的企业数
hysjk_basic_jjlx =select z.azcmc,Count(t.b10) from qyxx t ,zcdmk z Where z.azclx = t.b10 And  t.b07 = ? And t.yy= ?  Group By z.azcmc
hysjk_basic_jjlx2 =select z.azcmc,Count(t.b10) from qyxx t ,zcdmk z Where z.azclx = t.b10 And t.yy= ?  Group By z.azcmc
hysjk_basic_jjlx3 =select z.azcmc,Count(t.b10) from qyxx t ,zcdmk z Where z.azclx = t.b10 And t.b07 = ?  Group By z.azcmc
hysjk_basic_jjlx4 =select z.azcmc,Count(t.b10) from qyxx t ,zcdmk z Where z.azclx = t.b10  Group By z.azcmc

#行业数据库-〉基本概况：根据行业和年查询企业规模的企业数
hysjk_basic_gmlx = select t.b2213,Count(t.b2213) from qyxx t Where t.b07 = ?  And t.yy = ?  Group By t.b2213
hysjk_basic_gmlx2 = select t.b2213,Count(t.b2213) from qyxx t Where  t.yy = ?  Group By t.b2213
hysjk_basic_gmlx3 = select t.b2213,Count(t.b2213) from qyxx t Where t.b07 = ?   Group By t.b2213
hysjk_basic_gmlx4 = select t.b2213,Count(t.b2213) from qyxx t  Group By t.b2213

#根据行业和年份获取各省市企业数量,用于中国地图的数据展示
hygkfb_chinamap_qys=Select nvl(table1.qys,0), table2.name2 From  ( select Sum(t.qys) qys, d.name name1 from regionqys t , dict_entry d  Where t.xt_dzdm = d.pkid And t.hydlm = ?  And t.yy = ? And t.xt_dzdm!= '00'  Group By d.Name Order By d.Name ) table1,  ( select Distinct d.name name2 from regionqys t , dict_entry d  Where t.xt_dzdm = d.pkid And t.xt_dzdm!= '00'  ) table2 Where table1.Name1(+) = table2.Name2
hygkfb_chinamap_qys2=Select nvl(table1.qys,0), table2.name2 From  ( select Sum(t.qys) qys, d.name name1  from regionqys t , dict_entry d  Where t.xt_dzdm = d.pkid And t.yy = ?  And t.xt_dzdm!= '00' Group By d.Name Order By d.Name ) table1,  ( select Distinct d.name name2 from regionqys t , dict_entry d  Where t.xt_dzdm = d.pkid And t.xt_dzdm!= '00'  ) table2 Where table1.Name1(+) = table2.Name2
hygkfb_chinamap_qys3=Select nvl(table1.qys,0), table2.name2  From  ( select Sum(t.qys) qys,d.name  Name1 from regionqys t , dict_entry d  Where t.xt_dzdm = d.pkid And t.hydlm = ? And t.xt_dzdm!= '00'   Group By d.Name Order By d.Name ) table1,    ( select Distinct d.name name2 from regionqys t , dict_entry d    Where t.xt_dzdm = d.pkid And t.xt_dzdm!= '00'  ) table2   Where table1.Name1(+) = table2.Name2
hygkfb_chinamap_qys4=Select nvl(table1.qys,0), table2.name2 From  ( select Sum(t.qys) qys, d.name name1  from regionqys t , dict_entry d  Where t.xt_dzdm = d.pkid And t.xt_dzdm!= '00' Group By d.Name Order By d.Name ) table1,  ( select Distinct d.name name2 from regionqys t , dict_entry d  Where t.xt_dzdm = d.pkid And t.xt_dzdm!= '00'  ) table2 Where table1.Name1(+) = table2.Name2


#根据行业和年份获取生产规模集中度分布图
hygkfb_scgmjzd=select qys,t.b2213 from hygmqys t Where t.hydlm = ? And t.yy = ? order by t.b2213
hygkfb_scgmjzd2=select sum(qys),t.b2213 from hygmqys t Where  t.yy = ? Group By t.b2213 order by t.b2213
hygkfb_scgmjzd3=select sum(qys),t.b2213 from hygmqys t Where t.hydlm = ?  Group By t.b2213 order by t.b2213
hygkfb_scgmjzd4=select sum(qys),t.b2213 from hygmqys t  Group By t.b2213 order by t.b2213

#根据行业和年份获取 经济类型集中度
#国有企业 gyqy
#集体企业 jtqy
#股份合作企业 gfhzqy
#股份有限公司 gfyxgs
#私营企业 syqy
#港澳台商投资企业 gatstzqy
#外商投资企业 wstzqy
#其他 qt
hygkfb_jjlxjzd=Select Sum(qys) , 'gyqy'  as jjlx  from hyjjlxqys t where t.b10 = '110' and   t.hydlm = ? And t.yy =?  union Select Sum(qys) , 'jtqy'  from hyjjlxqys t where t.b10 = '120' And  t.hydlm = ? And t.yy =? union Select  Sum(qys), 'gfhzqy' from hyjjlxqys t where t.b10 = '130' and  t.hydlm = ? And t.yy =? union Select  Sum(qys) , 'gfyxgs' from hyjjlxqys t where t.b10 = '160' and t.hydlm = ? And t.yy =? union Select Sum(qys) , 'syqy' from hyjjlxqys t where t.b10 like '17%'  and t.hydlm = ? And t.yy =? union Select Sum(qys) , 'gatstzqy' from hyjjlxqys t where t.b10 like '2%' and t.hydlm = ? And t.yy =?  union Select Sum(qys) ,'wstzqy' from hyjjlxqys t where t.b10 like '3%'  and t.hydlm = ? And t.yy =? union Select Sum(qys) ,'qt' from hyjjlxqys t where t.b10 in ('141', '142', '143', '149', '151', '159', '190') and  t.hydlm = ? And t.yy =?
hygkfb_jjlxjzd2=Select Sum(qys) , 'gyqy'  as jjlx  from hyjjlxqys t where t.b10 = '110'  And t.yy =?  union Select Sum(qys) , 'jtqy'  from hyjjlxqys t where t.b10 = '120' And t.yy =? union Select  Sum(qys), 'gfhzqy' from hyjjlxqys t where t.b10 = '130' And t.yy =? union Select  Sum(qys) , 'gfyxgs' from hyjjlxqys t where t.b10 = '160' and  t.yy =? union Select Sum(qys) , 'syqy' from hyjjlxqys t where t.b10 like '17%'  And t.yy =? union Select Sum(qys) , 'gatstzqy' from hyjjlxqys t where t.b10 like '2%'  And t.yy =?  union Select Sum(qys) ,'wstzqy' from hyjjlxqys t where t.b10 like '3%'   And t.yy =? union Select Sum(qys) ,'qt' from hyjjlxqys t  where t.b10 in ('141', '142', '143', '149', '151', '159', '190') And t.yy =?
hygkfb_jjlxjzd3=Select Sum(qys) , 'gyqy'  as jjlx  from hyjjlxqys t where t.b10 = '110' and   t.hydlm = ?   union Select Sum(qys) , 'jtqy'  from hyjjlxqys t where t.b10 = '120' And  t.hydlm = ?  union Select  Sum(qys), 'gfhzqy' from hyjjlxqys t where t.b10 = '130' and  t.hydlm = ?  union Select  Sum(qys) , 'gfyxgs' from hyjjlxqys t where t.b10 = '160' and t.hydlm = ?  union Select Sum(qys) , 'syqy' from hyjjlxqys t where t.b10 like '17%'  and t.hydlm = ?  union Select Sum(qys) , 'gatstzqy' from hyjjlxqys t where t.b10 like '2%' and t.hydlm = ?   union Select Sum(qys) ,'wstzqy' from hyjjlxqys t where t.b10 like '3%'  and t.hydlm = ?  union Select Sum(qys) ,'qt' from hyjjlxqys t where t.b10 in ('141', '142', '143', '149', '151', '159', '190') and  t.hydlm = ?
hygkfb_jjlxjzd4=Select Sum(qys) , 'gyqy'  as jjlx  from hyjjlxqys t where t.b10 = '110'   union Select Sum(qys) , 'jtqy'  from hyjjlxqys t where t.b10 = '120'  union Select  Sum(qys), 'gfhzqy' from hyjjlxqys t where t.b10 = '130'  union Select  Sum(qys) , 'gfyxgs' from hyjjlxqys t where t.b10 = '160'  union Select Sum(qys) , 'syqy' from hyjjlxqys t where t.b10 like '17%'   union Select Sum(qys) , 'gatstzqy' from hyjjlxqys t where t.b10 like '2%'  union Select Sum(qys) ,'wstzqy' from hyjjlxqys t where t.b10 like '3%'   union Select Sum(qys) ,'qt' from hyjjlxqys t where t.b10 in ('141', '142', '143', '149', '151', '159', '190')

#数据查询3级页面
#行业数据库行业现状（经济效益）按年查询
hysjk_year=Select XSLRL,CBFYL,CCZZL,ZCFZL,LZZL,LDSCL,V210,V211,F304,F305,F391,F318,F319,F389,F322,F327,F330,F328,F336,F340,F341,F342,F7,F343,F349,F353,F356,QJFY,RJGZ,LDBL,SDBL,F390,F306,F308,F325,F344  From hyk  Where B07= ? And yy= ?
#行业数据库行业现状（经济效益）按年月查询
hysjk_yearmonth= Select A02_1,A02_L,A04_1,A04_L,A06_1,A06_L,A17_1,A17_L,A20_1,A20_L,A29_1,A29_L,A31_1,A31_L,A32_1,A32_L,A34_1,A34_L,A40_1,A40_L,A44_1,A44_L,A45_1,A45_L,A48_1,A48_L,BTR_1,BTR_L,ZJZ_L,XSZZ_L,XSLR_L,XSLR_TB,CBFY_L,CBFY_TB,CCZJ_L,CCZJ_TB,ZCFZ_L,ZCFZ_TB,LDZZ_L,LDZZ_TB,A48_1 from xyhyk Where AHYXL = ? And yymm= ?
#产业(产品)数据库产销概况三级页面
cycpsjk_cxgk = select QYS,   concat(P1,DW) As P1, L1 ,concat(J1,DW) As J1 ,L3 ,concat(P2,DW) As P2, L2 from cljbk t Where t.sxm = ? And t.yyjj = ?
#产业(产品)数据库经济效益三级页面
cycpsjk_jjxy = select concat(DXSL,DW) As DXSL, concat(SXSL,DW) SXSL ,concat(DZYL,DW) DZYL ,concat(SZYL,DW) SZYL ,DCXL,KCZJ,concat(DSCL,DW) As DSCL,concat(SCXL,DW) As SCXL,concat(SKCZJ,DW) As SKCZJ from cxck t Where t.sxm = ? And  t.yyj = ?
#企业数据库（企业基本信息）三级页面
qysjk= Select b02, ADDRESS,  PHONE ,B063,B065,B066,B067, PRODUCT  from qyxx t  Where t.pkid = ? And yy = ?
#区域数据库产量三级页面
qyusjk_cl=select yymm,QYS as qqys, P1,L1 as qql1, P2,L2 as qql2   from cldqk t  Where t.sxm = ? And substr(t.xt_dzdm,1,2) = ?  And t.yymm Like ?  Union Select Distinct'1000000' ,999999,c.dwdm, 100100,c.dwdm,100100 from cldqk t ,cpdw c Where t.sxm = ?  And t.dw =c.dwmc
#区域数据库产值三级页面
qyusjk_cz=Select yymm, A90_1,A90_TB,B03_1,B03_TB,B03_L,B03_LZJ,B04_1,B04_TB,B04_L,B04_LZJ,B05_1,B05_TB,B05_BZ,B05_BZZJ  from czdqk t  Where  t.hydlm = ? And t.xt_dzdm = ?  And t.yymm Like ?  Order By yymm
#区域数据库经济效益三级页面
qyusjk_jjxy= Select yymm,A02_1,A02_L,A04_1,A04_L,A06_1,A06_L,A17_1,A17_L,A20_1,A20_L,A29_1,A29_L,A31_1,A31_L,A32_1,A32_L,A34_1,A34_L,A40_1,A40_L,A44_1,A44_L,A45_1,A45_L,A48_1,A48_L,BTR_1,BTR_L,ZJZ_L,XSZZ_L,XSLR_L,CBFY_L,CCZJ_L,ZCFZ_L,LDZZ_L,A48_1   from xydqk Where HYDLM = ? And substr(XT_DZDM,1,2) = ? And yymm Like  ? Order By yymm

#根据行业和年份获取六大区域集中度分布图
hygkfb_qyufb = select Sum(t.qys),d.name  from regionqys t , dict_entry d  Where t.qydm = d.pkid And t.hydlm = ? And t.yy = ?  And t.xt_dzdm!= '00' Group By d.Name Order By d.Name
hygkfb_qyufb2 =select Sum(t.qys),d.name  from regionqys t , dict_entry d Where t.qydm = d.pkid And t.yy = ? And t.xt_dzdm!= '00' Group By d.Name Order By d.Name
hygkfb_qyufb3 =select Sum(t.qys),d.name  from regionqys t , dict_entry d  Where t.qydm = d.pkid And t.hydlm = ? And t.xt_dzdm!= '00' Group By d.Name Order By d.Name
hygkfb_qyufb4 =select Sum(t.qys),d.name  from regionqys t , dict_entry d  Where t.qydm = d.pkid And t.xt_dzdm!= '00' Group By d.Name Order By d.Name


#数据导读-〉行业现状-〉新产品产值率
sjdd_hyxz_xcpcz=select t.b03_l as HYXZ_B03_L ,substr(YYMM,5,6)  from czhyk t Where t.hydlm = ? And t.ahyxl = ? And t.yymm Like ? Order By t.yymm
#数据导读-〉行业现状-〉产值增加率
sjdd_hyxz_czzjl=select t.A90_TB as HYXZ_A90_TB , substr(YYMM,5,6)  from czhyk t Where t.hydlm = ? And t.ahyxl = ? And t.yymm Like ? Order By t.yymm
#数据导读-〉行业现状-〉工业增加值率
sjdd_hyxz_gyzjzl=select t.ZJZ_L as HYXZ_ZJZ_L ,substr(YYMM,5,6) from xyhyk t Where t.hydlm = ? And t.ahyxl = ? And t.yymm Like ? Order By t.yymm
#数据导读-〉行业现状-〉产品销售率
sjdd_hyxz_cpss=select t.dcxl as HYXZ_DCXL ,substr(YYJ,5,5) from cxck t Where t.hydlm = ? And  t.sxm = ? And t.yyj Like ? Order By t.yyj
#数据导读-〉行业经济效益
sjdd_hyjjxy = select {0}  from {1} {2}
#数据导读-〉产业产品产销概况->累计产量
sjdd_cpgk_cl = Select p1 As CCC_P1 , substr(YYMM,5,6)  from clhzk t Where t.hydlm =? And t.sxm = ? And t.yymm Like ?
#数据导读-〉产业产品产销概况->累计产量同比增长率
sjdd_cpgk_clzzl = Select l1 As  CCC_L1, substr(YYMM,5,6)  from clhzk t Where t.hydlm =? And t.sxm = ? And t.yymm Like ?
#数据导读-〉产业产品产销概况->累计销售量
sjdd_cpgk_cx = select DXSL As CCC_DXSL, substr(YYJ,5,5) from cxck t Where t.hydlm = ? And t.sxm = ? And t.yyj Like ?
#数据导读-〉产业产品产销概况->产销率
sjdd_cpgk_cxl= select DCXL As CCC_DCXL, substr(YYJ,5,5) from cxck t Where t.hydlm = ? And t.sxm = ? And t.yyj Like ?
#查询产品单位
sjdd_dw=select  dw  from cpdmk  t Where t.sxm = ?
#数据对标-〉国内对标
sjdd_hyjjxy= SELECT row_.* FROM ( select {0}  from {1} {2} ) row_ WHERE rownum <= 10

#数据查询-〉进出口数据库
sjcx_jcksjk = select t.path,substr(yymm,1,4) As Year ,substr(yymm,5,6) As Month ,  d.Name , t.Category ,t.port  from customs t ,dict_entry d  {0}
#招聘网数据统计(只统计河北省下所有市和河北省以外的机构(在招聘组下的机构)，职位，简历数量)
recruit_statistics = select * from recruit_statistics t  Order By t.Orderno
#统计(统计某个分类的所有枚举类型属性的字典值的数量)
#统计方式：对string_value,long_value俩个表作监测
statistics = select p.name,d.name,t.num,d.orderno from statistics_category t,dict_entry d,property_definition p  Where t.categoryid =?  And t.dict_value =d.pkid  And p.pkid =t.property Order By d.orderno
#课程的统计
coursestat = Select Rrow_.Node_Id, rrow_.coursename,rrow_.dotcount,rrow_.collnum,rrow_.buynum,rrow_.allpoints,rrow_.stuscore 	From (Select Row_.Node_Id    As Node_Id, row_.coursename As coursename,row_.dotcount As dotcount,row_.collnum As collnum,row_.buynum As buynum,row_.allpoints As allpoints,row_.stuscore As stuscore, Rownum Rownum_  	From (Select * From v_Course_Statistics t Where t.Owner = ?) Row_   Where Rownum <= ?) rrow_  Where Rownum_ > ?
coursestatcounts = select Count(t.coursename) from v_course_statistics t Where t.owner =?
#歌华剩余票数的统计，按天 5个参数 分别为起始日期，终止日期,起始日期，起始日期,终止日期
gehuapw=Select T2.Days, (Select Constraint From Property_Constraints t	Where t.Node_Id = 'ticketOrder'	And t.Property_Definition_Id = 'ticketNum'And Ascii(Constraint) Between 48 And 57) - T2.Saled	From (Select Tem.Days Days, Sum(Tem.Saled) Saled	From (Select Trunc(d.Value, 'dd') Days, Sum(l.Value) Saled	From Long_Value l, Date_Value d	 Where l.Node_Id In (Select t.Node_Id From Content t		Where t.Category_Id = '2432505723098'	And t.Del_Flag = '0' And State = 'end') And l.Property_Id = 'ticketNum' And d.Property_Id = 'tickDate'	 And d.Node_Id = l.Node_Id	 And d.Value Between To_Date(?, 'yyyy-mm-dd') And To_Date(?, 'yyyy-mm-dd') Group By Trunc(d.Value, 'dd') Union 	Select To_Date(?, 'yyyy-mm-dd') + (Level - 1), 0	From Dual	Connect By Trunc(To_Date(?, 'yyyy-mm-dd')) + (Level - 1) <= Trunc(To_Date(?, 'yyyy-mm-dd'))) Tem Group By Tem.Days) T2  Order By T2.Days

#软协会费年度统计表不用的(不使用)
#ruanxieyearstat=Select o.Enterprisename,			 D1.Name,			 D2.Name,			 B1.Value,			 Du1.Value,			 Du2.Value,			 Du3.Value,			 Da.Value,			 Cb.Value	From Content         c,			 Reference_Value r,			 Organization    o,			 String_Value    Spost,			 Dict_Entry      D1,			 String_Value    Sfpost,			 Dict_Entry      D2,			 Boolean_Value   B1,			 Double_Value    Du1,			 Double_Value    Du2,			 Double_Value    Du3,			 Date_Value      Da,			 Clob_Value      Cb Where c.Category_Id = '2435141659092' 	 And c.Node_Id = r.Node_Id	 And r.Property_Id = 'post-content-ref'	 And o.Id = r.Value	 And Spost.Node_Id = c.Node_Id	 And Spost.Property_Id = 'asspost'	 And D1.Pkid = Spost.Value	 And Sfpost.Node_Id = c.Node_Id	 And Sfpost.Property_Id = 'bracherpost'	 And D2.Pkid = Sfpost.Value	 And B1.Node_Id = c.Node_Id	 And B1.Property_Id = 'isfree'	 And Du1.Node_Id = c.Node_Id	 And Du1.Property_Id = 'amountneeded'	 And Du2.Node_Id = c.Node_Id	 And Du2.Property_Id = 'amoutpaid'	 And Du3.Node_Id = c.Node_Id	 And Du3.Property_Id = 'assamoutpaid'	 And Da.Node_Id = c.Node_Id	 And Da.Property_Id = 'paiddate'	 And Cb.Node_Id = c.Node_Id	 And Cb.Property_Id = 'remark' Order By da.Value Desc
#软协年度缴费统计 值：六个相同的年份，如（2007，2007，2007，2007，2007，2007）（不使用）
#ruanxieyearstat =Select '常务理事', T1.Totall, T2.Have, T3.Free,	 Decode(T2.Have, 0, 0, (T1.Totall - T3.Free) / T2.Have) * 100	From (Select Count(*) As Totall 		From Content c	 Where c.Category_Id = '2434948922030' And c.Del_Flag = '0' And Exists (Select * 	From String_Value s	 Where s.Property_Id = 'asspost' And s.Value = 'ruanxiepost1'	 And s.Node_Id = c.Node_Id) ) T1,  (Select Count(*) As Have 	From Content C1  Where C1.Category_Id = '2435141659092' And C1.Del_Flag = '0'  And Exists (Select * 	From Double_Value D1  Where D1.Property_Id = 'amoutpaid' And D1.Value > 0	 And D1.Node_Id = C1.Node_Id)	 And Exists (Select * 	From String_Value s	 Where s.Property_Id = 'asspost' And s.Value = 'ruanxiepost1'	 And s.Node_Id = C1.Node_Id) And Exists (Select *	From String_Value Da  Where Da.Property_Id = 'prop390' And Da.Node_Id = C1.Node_Id	 And Da.Value = ?) ) T2,  (Select Count(*) As Free		From Content C1	 Where C1.Category_Id = '2435141659092'		 And C1.Del_Flag = '0' And Exists (Select *  From Boolean_Value B1 Where B1.Property_Id = 'isfree' And B1.Value > 0 And B1.Node_Id = C1.Node_Id)   And Exists (Select *					From String_Value s		 Where s.Property_Id = 'asspost'	 And s.Value = 'ruanxiepost1'  And s.Node_Id = C1.Node_Id)		 And Exists (Select *			From String_Value Da	 Where Da.Property_Id = 'prop390'  And Da.Node_Id = C1.Node_Id		 And Da.Value = ?)) T3 Union All Select '理事',	 T1.Totall,  T2.Have,	 T3.Free,	 Decode(T2.Have, 0, 0, (T1.Totall - T3.Free) / T2.Have) * 100  	From (Select Count(*) As Totall 	From Content c	 Where c.Category_Id = '2434948922030' 	 And c.Del_Flag = '0'		 And Exists (Select *	From String_Value s			 Where s.Property_Id = 'asspost'  And s.Value = 'ruanxiepost2' And s.Node_Id = c.Node_Id)	) T1,	 (Select Count(*) As Have 	From Content C1	 Where C1.Category_Id = '2435141659092'	 And C1.Del_Flag = '0' And Exists (Select *	From Double_Value D1		 Where D1.Property_Id = 'amoutpaid'		 And D1.Value > 0	 And D1.Node_Id = C1.Node_Id) 	 And Exists (Select *		From String_Value s		 Where s.Property_Id = 'asspost' And s.Value = 'ruanxiepost2'   And s.Node_Id = C1.Node_Id)	 And Exists (Select *	From String_Value Da		 Where Da.Property_Id = 'prop390' 	 And Da.Node_Id = C1.Node_Id And Da.Value = ?)) T2, 	 (Select Count(*) As Free			From Content C1	 Where C1.Category_Id = '2435141659092'	 And C1.Del_Flag = '0' 	 And Exists (Select * From Boolean_Value B1	 Where B1.Property_Id = 'isfree' And B1.Value > 0 	 And B1.Node_Id = C1.Node_Id)		 And Exists (Select *		From String_Value s		 Where s.Property_Id = 'asspost' 	 And s.Value = 'ruanxiepost2'		 And s.Node_Id = C1.Node_Id)	 And Exists (Select *	From String_Value Da  Where Da.Property_Id = 'prop390'				 And Da.Node_Id = C1.Node_Id  And Da.Value = ?)) T3 Union All  Select '会员',T1.Totall,T2.Have,T3.Free, Decode(T2.Have, 0, 0, (T1.Totall - T3.Free) / T2.Have) * 100	From (Select Count(*) As Totall   From Content c		 Where c.Category_Id = '2434948922030'	 And c.Del_Flag = '0' And Exists (Select *	From String_Value s  Where s.Property_Id = 'asspost'		 And s.Value = 'ruanxiepost3'	 And s.Node_Id = c.Node_Id)) T1,  (Select Count(*) As Have	From Content C1	 Where C1.Category_Id = '2435141659092' And C1.Del_Flag = '0'   And Exists (Select *		From Double_Value D1 Where D1.Property_Id = 'amoutpaid' And D1.Value > 0  And D1.Node_Id = C1.Node_Id)	 And Exists (Select *	From String_Value s	 Where s.Property_Id = 'asspost'  And s.Value = 'ruanxiepost3' And s.Node_Id = C1.Node_Id) And Exists (Select * From String_Value Da  Where Da.Property_Id = 'prop390' And Da.Node_Id = C1.Node_Id And Da.Value = ?)) T2, (Select Count(*) As Free From Content C1 Where C1.Category_Id = '2435141659092'	 And C1.Del_Flag = '0'  And Exists (Select *	From Boolean_Value B1	 Where B1.Property_Id = 'isfree' And B1.Value > 0  And B1.Node_Id = C1.Node_Id) And Exists (Select * 	From String_Value s	 Where s.Property_Id = 'asspost'   And s.Value = 'ruanxiepost3'	 And s.Node_Id = C1.Node_Id)		 And Exists (Select * From String_Value Da   Where Da.Property_Id = 'prop390'		 And Da.Node_Id = C1.Node_Id  And Da.Value = ?)) T3

#软协年度缴费统计 值：3个相同的年份，如（2007，2007，2007）
ruanxiePerYearStat =Select ok.postname,ok.allnum,ok.paidnum,ok.freenum,ok.paidnum/decode((ok.allnum-ok.freenum),0,1,(Ok.Allnum - Ok.Freenum))*100 From ( Select t0.Name postname,nvl(t0.num,0) allnum ,nvl(t1.Num,0) paidnum, nvl(t2.num,0) freenum From (Select d.Name Name ,dc.num num From dict_entry d, (Select s.Value As pkid , Count(*) num From content c ,String_Value s Where c.category_id ='2435141659092' And c.del_flag ='0'  And s.property_id ='asspost'  And s.Node_Id =c.Node_Id And Exists (Select * From String_Value s Where s.Property_Id = 'prop390' And s.Node_Id = c.Node_Id And s.Value = ?) Group By  s.value) dc Where d.parent_id ='ruanxiepost' And d.pkid =dc.pkid(+) ) t0 Left Join (Select dc.Name Name, dt.num num From dict_entry dc , (Select  s.Value pkid ,count(*) num From content c ,Double_Value d,String_Value s  Where c.category_id ='2435141659092' And c.del_flag ='0' And d.property_id ='amoutpaid' And d.value>0 And d.Node_Id = c.Node_Id And s.property_id ='asspost' And s.Node_Id =c.Node_Id And Exists (Select *  From String_Value s Where s.property_id ='prop390' And s.node_id =c.node_id And s.value=?) Group By s.Value) dt Where dc.parent_id ='ruanxiepost' And dc.pkid =dt.pkid(+) ) t1 On t1.Name =t0.Name Left Join (Select dc.Name Name, dt.num num  From dict_entry dc ,  (Select  s.Value pkid ,count(*) num From content c ,boolean_Value b,String_Value s  Where c.category_id ='2435141659092' And c.del_flag ='0' And b.property_id ='isfree' And b.Value='1' And b.Node_Id = c.Node_Id And s.property_id ='asspost' And s.Node_Id =c.Node_Id And Exists (Select *  From String_Value s Where s.property_id ='prop390' And s.node_id =c.node_id And s.value=?) Group By s.Value) dt Where dc.parent_id ='ruanxiepost' And dc.pkid =dt.pkid(+)) t2 On t2.Name = t0.Name ) ok

#银河培训按省统计
gtpProvinceOrgCount =select i.node_id,i.value,i.jgs,j.orderno from (select h.node_id,h.value,sum(case pxs when 0 then 0 else 1 end) as jgs from (select w.node_id, w.value, t.value as jg, count(t.node_id) as pxs from reference_value x, (select z.node_id, value from string_value z, (select pkid from node_type where definition = 'dept-scheme') y where z.node_id = y.pkid and z.property_id = 'user-commonname') w, (select v.value, r.node_id from reference_value v, (select a.node_id,a.value as value from date_value a, (select pkid from node_type where definition = '2538792608203') b where a.node_id = b.pkid and property_id = 'tBeginDate') u, (select node_id from string_value where value = '\u5df2\u53d1\u5e03') r where v.node_id = u.node_id and u.node_id = r.node_id(+) and (u.value between ? and ?) and v.property_id = 'creator') t where w.node_id = x.value and (x.property_id = 'creator' or x.property_id is null) and x.node_id = t.value(+) group by w.node_id, w.value, t.value) h group by h.node_id, h.value) i ,node j where i.node_id =j.pkid order by j.orderno desc
gtpProvinceTrainCount=select i.bm,i.value,i.pxcs,j.orderno from (select s.bm, s.value, nvl(count(t.node_id), 0) as pxcs from (select x.node_id as jg, w.node_id as bm, w.value from reference_value x,(select z.node_id, value from string_value z,(select pkid from node_type where definition = 'dept-scheme') y where z.node_id = y.pkid and z.property_id = 'user-commonname') w where w.node_id = x.value(+) and (x.property_id = 'creator' or x.property_id is null)) s,(select v.value, r.node_id from reference_value v,(select a.node_id, a.value as value from date_value a, (select pkid from node_type where definition = '2538792608203') b where a.node_id = b.pkid and property_id = 'tBeginDate') u, (select node_id from string_value where value = '\u5df2\u53d1\u5e03') r where v.node_id = u.node_id and u.node_id = r.node_id(+) and (u.value between ? and ?) and v.property_id = 'creator') t where s.jg = t.value(+) group by s.bm, s.value) i ,node j where i.bm =j.pkid order by j.orderno desc
gtpProvinceTrainTime=select i.bm,i.value,i.pxsj,j.orderno from (select s.bm, s.value, nvl(sum(q.value), 0) as pxsj from (select x.node_id as jg, w.node_id as bm, w.value from reference_value x, (select z.node_id, value from string_value z, (select pkid from node_type where definition = 'dept-scheme') y where z.node_id = y.pkid and z.property_id = 'user-commonname') w where w.node_id = x.value(+) and (x.property_id = 'creator' or x.property_id is null)) s,(select t.value as jg, r.node_id, r.value from long_value r, (select v.value, r.node_id from reference_value v,(select a.node_id, a.value as value from date_value a, (select pkid from node_type where definition = '2538792608203') b where a.node_id = b.pkid and property_id = 'tBeginDate') u,(select node_id from string_value where value = '\u5df2\u53d1\u5e03') r where v.node_id = u.node_id and u.node_id = r.node_id(+) and (u.value between ? and ?) and v.property_id = 'creator') t where r.node_id = t.node_id and property_id = 'tHour') q where s.jg = q.jg(+) group by s.bm, s.value) i ,node j where i.bm =j.pkid order by j.orderno desc
gtpProvinceTrainPerson=select i.bm,i.value,i.pxzrs,j.orderno from (select s.bm, s.value, nvl(count(p.value), 0) as pxzrs from (select x.node_id as jg, w.node_id as bm, w.value from reference_value x, (select z.node_id, value from string_value z, (select pkid from node_type  where definition = 'dept-scheme') y where z.node_id = y.pkid and z.property_id = 'user-commonname') w  where w.node_id = x.value(+) and (x.property_id = 'creator' or x.property_id is null)) s,  (select v.node_id, v.value from reference_value v, (select pkid from node_type where definition = '2538792608203') u where v.node_id = u.pkid  and v.property_id = 'student') p,(select v.value, r.node_id from reference_value v, (select a.node_id, a.value as value from date_value a,(select pkid  from node_type where definition = '2538792608203') b  where a.node_id = b.pkid and property_id = 'tBeginDate') u, (select node_id from string_value where value = '\u5df2\u53d1\u5e03') r where v.node_id = u.node_id and u.node_id = r.node_id(+) and (u.value between ? and ?) and v.property_id = 'creator') t where t.node_id = p.node_id(+) and s.jg = t.value(+) group by s.bm, s.value) i ,node j where i.bm =j.pkid order by j.orderno desc
gtpProvinceFeedback=select i.bm,i.value,i.zfsms,j.orderno from (select s.bm, s.value, nvl(count(k.value), 0) as zfsms from (select v.value, r.node_id from reference_value v, (select a.node_id, a.value as value from date_value a, (select pkid  from node_type where definition = '2538792608203') b where a.node_id = b.pkid and property_id = 'tBeginDate') u, (select node_id from string_value where value = '\u5df2\u53d1\u5e03') r where v.node_id = u.node_id and u.node_id = r.node_id(+) and (u.value between ? and ?) and v.property_id = 'creator') t, (select x.node_id as jg, w.node_id as bm, w.value from reference_value x, (select z.node_id, value from string_value z, (select pkid from node_type where definition = 'dept-scheme') y  where z.node_id = y.pkid  and z.property_id = 'user-commonname') w where w.node_id = x.value(+) and (x.property_id = 'creator' or x.property_id is null)) s, (select m.value, m.node_id from string_value m, (select pkid from node_type where definition = '2539181684555') n where m.node_id = n.pkid and property_id = 'creator') l, (select m.value, m.node_id from string_value m, (select pkid from node_type where definition = '2539181684555') n where m.node_id = n.pkid and property_id = 'prop4' and value = 'success') k where l.node_id = k.node_id(+) and t.node_id = l.value(+) and s.jg = t.value(+) group by s.bm, s.value) i ,node j where i.bm =j.pkid order by j.orderno desc
gtpProvincePerson=select i.bm,i.value,i.fkrs,j.orderno from (select s.bm, s.value, nvl(sum(q.value), 0) as fkrs from (select x.node_id as jg, w.node_id as bm, w.value from reference_value x, (select z.node_id, value  from string_value z, (select pkid from node_type where definition = 'dept-scheme') y where z.node_id = y.pkid and z.property_id = 'user-commonname') w  where w.node_id = x.value(+) and (x.property_id = 'creator' or x.property_id is null)) s, (select t.value as jg, r.node_id, r.value from long_value r, (select v.value, r.node_id from reference_value v, (select a.node_id, a.value as value from date_value a,(select pkid from node_type where definition = '2538792608203') b where a.node_id = b.pkid and property_id = 'tBeginDate') u, (select node_id from string_value where value = '\u5df2\u53d1\u5e03') r where v.node_id = u.node_id and u.node_id = r.node_id(+) and (u.value between ? and ?) and v.property_id = 'creator') t  where r.node_id = t.node_id and property_id = 'prop2') q where s.jg = q.jg(+) group by s.bm, s.value) i ,node j where i.bm =j.pkid order by j.orderno desc
gtpProvinceAvgSatis=select i.node_id,i.value,i.pjmy,j.orderno from (select f.node_id, f.value, round(nvl(avg(my)*100,0),2) as pjmy from (select w.node_id, w.value, t.value as jg, nvl2(t.node_id, e.value, 0) as my from reference_value x, (select z.node_id, value from string_value z,  (select pkid  from node_type  where definition = 'dept-scheme') y  where z.node_id = y.pkid and z.property_id = 'user-commonname') w, (select v.value, r.node_id from reference_value v, (select a.node_id,  a.value as value  from date_value a, (select pkid  from node_type where definition = '2538792608203') b  where a.node_id = b.pkid  and property_id = 'tBeginDate') u, (select node_id from string_value where value = '\u5df2\u53d1\u5e03') r where v.node_id = u.node_id and u.node_id = r.node_id(+)  and (u.value between ? and ?) and v.property_id = 'creator') t, (select c.node_id, c.value from double_value c, (select * from node_type t where definition = 'org-scheme') d where c.node_id = d.pkid and property_id = 'prop12') e where w.node_id = x.value and t.value = e.node_id(+) and (x.property_id = 'creator' or x.property_id is null) and x.node_id = t.value  group by w.node_id, w.value, t.value,  e.value, t.node_id) f group by f.node_id, f.value) i ,node j where i.node_id =j.pkid order by j.orderno desc
#银河培训按培训机构统计
gtpOrgTrainCount=select i.node_id,i.pxjg,i.pxcs,j.orderno from (select y.node_id, y.value as pxjg ,s.pxcs from string_value y, (select t.value,count(t.node_id) as pxcs from reference_value x, (select v.value, r.node_id from reference_value v, (select a.node_id, a.value as value from date_value a, (select pkid from node_type where definition = '2538792608203') b where a.node_id = b.pkid and property_id = 'tBeginDate') u, (select node_id from string_value where value = '\u5df2\u53d1\u5e03') r where v.node_id = u.node_id and u.node_id = r.node_id(+)  and (u.value between ? and ? ) and v.property_id = 'creator') t where x.value=? and (x.property_id = 'creator' or x.property_id is null) and x.node_id = t.value group by t.value) s where s.value = y.node_id and property_id = 'org-enterprisename') i,node j where i.node_id=j.pkid order by j.orderno desc
gtpOrgTrainTime=select i.node_id,i.pxjg,i.pxzks,j.orderno from (select y.node_id, y.value as pxjg, s.pxzks from string_value y,(select x.node_id, nvl(sum(q.value), 0) as pxzks from reference_value x,(select t.value as jg, r.node_id, r.value from long_value r, (select v.value, r.node_id  from reference_value v, (select a.node_id,  a.value as value  from date_value a, (select pkid from node_type where definition = '2538792608203') b where a.node_id = b.pkid  and property_id = 'tBeginDate') u, (select node_id from string_value where value = '\u5df2\u53d1\u5e03') r where v.node_id = u.node_id and u.node_id = r.node_id(+)  and (u.value between ? and ?)  and v.property_id = 'creator') t  where r.node_id(+) = t.node_id and (property_id = 'tHour' or property_id is null)) q where x.value=? and (x.property_id = 'creator' or x.property_id is null) and x.node_id = q.jg group by x.node_id) s where s.node_id = y.node_id and property_id = 'org-enterprisename') i,node j where i.node_id=j.pkid order by j.orderno desc
gtpOrgTrainPersonCount=select i.node_id,i.pxjg,i.pxzrs,j.orderno from (select y.node_id, y.value as pxjg, s.pxzrs from string_value y, (select x.node_id, nvl(count(p.value), 0) as pxzrs from reference_value x, (select v.node_id, v.value from reference_value v, (select pkid from node_type where definition = '2538792608203') u where v.node_id = u.pkid  and v.property_id = 'student') p, (select v.value, r.node_id from reference_value v, (select a.node_id, a.value as value from date_value a, (select pkid from node_type where definition = '2538792608203') b where a.node_id = b.pkid and property_id = 'tBeginDate') u, (select node_id from string_value where value = '\u5df2\u53d1\u5e03') r where v.node_id = u.node_id and u.node_id = r.node_id(+) and (u.value between ? and ?) and v.property_id = 'creator') t where t.node_id = p.node_id(+) and x.value=? and (x.property_id = 'creator' or x.property_id is null) and x.node_id = t.value group by x.node_id) s where s.node_id = y.node_id and property_id = 'org-enterprisename') i,node j where i.node_id=j.pkid order by j.orderno desc
gtpOrgFeedbackPersonCount=select i.node_id,i.pxjg,i.zfrs,j.orderno from (select y.node_id, y.value as pxjg, s.zfrs from string_value y, (select x.node_id, nvl(count(k.value), 0) as zfrs from reference_value x,  (select v.value, r.node_id  from reference_value v, (select a.node_id, a.value as value from date_value a, (select pkid from node_type  where definition = '2538792608203') b where a.node_id = b.pkid  and property_id = 'tBeginDate') u, (select node_id from string_value where value = '\u5df2\u53d1\u5e03') r where v.node_id = u.node_id and u.node_id = r.node_id(+) and (u.value between ? and ?) and v.property_id = 'creator') t,  (select m.value, m.node_id  from string_value m, (select pkid from node_type where definition = '2539181684555') n where m.node_id = n.pkid  and property_id = 'prop0') l, (select m.value, m.node_id from string_value m, (select pkid from node_type where definition = '2539181684555') n where m.node_id = n.pkid  and property_id = 'prop4'  and value = 'success') k where l.node_id = k.node_id(+) and t.node_id = l.value(+)  and x.value=? and (x.property_id = 'creator' or x.property_id is null) and x.node_id = t.value group by x.node_id) s where s.node_id = y.node_id and property_id = 'org-enterprisename') i,node j where i.node_id=j.pkid order by j.orderno desc
gtpOrgPersonCount=select i.node_id,i.pxjg,i.zfsms,j.orderno from (select y.node_id, y.value as pxjg, s.zfsms from string_value y, (select x.node_id, nvl(sum(q.value), 0) as zfsms from reference_value x, (select t.value as jg, r.node_id, r.value from long_value r, (select v.value, r.node_id from reference_value v,  (select a.node_id,  a.value as value  from date_value a, (select pkid from node_type where definition = '2538792608203') b where a.node_id = b.pkid  and property_id = 'tBeginDate') u, (select node_id from string_value where value = '\u5df2\u53d1\u5e03') r where v.node_id = u.node_id and u.node_id = r.node_id(+) and (u.value between ? and ?) and v.property_id = 'creator') t  where r.node_id(+)= t.node_id  and (property_id = 'prop2' or property_id is null)) q where x.value=? and (x.property_id = 'creator' or x.property_id is null) and x.node_id = q.jg group by x.node_id) s where s.node_id = y.node_id and property_id = 'org-enterprisename') i,node j where i.node_id=j.pkid order by j.orderno desc
gtpOrgAvgSatis=select i.node_id,i.pxjg,i.pjmy,j.orderno from (select y.node_id, y.value as pxjg, s.pjmy from string_value y, (select x.node_id, round(nvl(avg(e.value)*100,0),2) as pjmy from reference_value x, (select v.value, r.node_id from reference_value v, (select a.node_id, a.value as value from date_value a, (select pkid from node_type where definition = '2538792608203') b where a.node_id = b.pkid and property_id = 'tBeginDate') u, (select node_id from string_value where value = '\u5df2\u53d1\u5e03') r where v.node_id = u.node_id and u.node_id = r.node_id(+)  and (u.value between ? and ?) and v.property_id = 'creator') t, (select c.node_id, c.value  from double_value c, (select * from node_type t  where definition = '2538792608203') d where c.node_id = d.pkid and property_id = 'prop1') e where t.node_id = e.node_id(+) and x.value=? and (x.property_id = 'creator' or x.property_id is null)  and x.node_id = t.value group by x.node_id) s where s.node_id = y.node_id and property_id = 'org-enterprisename') i,node j where i.node_id=j.pkid order by j.orderno desc



